openapi: 3.0.3
info:
  title: Translation API
  description: Chapter content translation to Urdu (Focus Mode)
  version: 1.0.0

servers:
  - url: http://localhost:8000/api
    description: Development server

tags:
  - name: Translation
    description: Content translation operations

paths:
  /translate:
    post:
      tags:
        - Translation
      summary: Translate chapter to Urdu
      description: |
        Translate chapter content to Urdu with Focus Mode (technical faithfulness).

        **Focus Mode Requirements**:
        - Faithful technical translation only
        - No extra commentary or explanations
        - Technical terms preserved in English or transliterated
        - Code snippets preserved unchanged

        **Performance**: Must complete in <15 seconds for chapters up to 5000 words (SC-003)
      operationId: translateChapter
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TranslateRequest'
      responses:
        '200':
          description: Chapter translated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TranslateResponse'
        '401':
          description: Unauthorized (invalid or missing JWT token)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '400':
          description: Bad request (invalid input)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '429':
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    TranslateRequest:
      type: object
      required:
        - chapterId
        - chapterContent
        - targetLanguage
        - mode
      properties:
        chapterId:
          type: string
          example: "module-1-chapter-3"
        chapterContent:
          type: string
          example: "# Chapter 3: Robot Kinematics\n\n## Introduction\n..."
          description: Original English markdown content
        targetLanguage:
          type: string
          enum: ["ur"]
          example: "ur"
          description: Target language (ISO 639-1 code, currently only Urdu supported)
        mode:
          type: string
          enum: ["focus"]
          example: "focus"
          description: Translation mode (currently only Focus Mode supported)

    TranslateResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            chapterId:
              type: string
              example: "module-1-chapter-3"
            translatedContent:
              type: string
              example: "# باب 3: روبوٹ کی Kinematics\n\n## تعارف\n..."
              description: Urdu markdown content
            metadata:
              type: object
              properties:
                llmModel:
                  type: string
                  example: "google/gemini-2.0-flash-exp:free"
                tokenUsage:
                  type: object
                  properties:
                    inputTokens:
                      type: integer
                      example: 2500
                    outputTokens:
                      type: integer
                      example: 3000
                processingTimeMs:
                  type: integer
                  example: 12000
                preservedTerms:
                  type: array
                  items:
                    type: string
                  example: ["kinematics", "forward kinematics", "Jacobian", "TCP"]
                  description: Technical terms preserved in English

    ErrorResponse:
      type: object
      properties:
        error:
          type: string
        details:
          type: object
          additionalProperties: true
